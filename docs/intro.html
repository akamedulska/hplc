<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.163">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RP-HPLC - General model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Model_1.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">General model</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">RP-HPLC</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Columns: XBridge Shield and XTerra</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">General model</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Model_1.html" class="sidebar-item-text sidebar-link">Model 1</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_1_a.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Stan code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_1_b.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimated parameters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_1_c.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comparison of population parameter values</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_1_d.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Comparison of individual parameter values</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Model_2.html" class="sidebar-item-text sidebar-link">Model 2</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_2_a.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stan code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_2_b.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estimated parameters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_2_c.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Comparison of population parameter values</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model2_logk.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">logk vs fi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_2_pH.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">logk vs pH</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Model_2_utility_pH.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Utility function</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./incomplete_code.html" class="sidebar-item-text sidebar-link">Incomplete stan code</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-analyte-level-model" id="toc-the-analyte-level-model" class="nav-link active" data-scroll-target="#the-analyte-level-model">The analyte-level model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">General model</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Retention time <span class="math inline">\(t_{R,z}\)</span> under organic modifier gradient was calculated utilizing the well-known integral equation:</p>
<p><span id="eq-tr"><span class="math display">\[
\int_0^{t_{R,z}-t_0-t_e}\frac{dt}{t_0\cdot ki_{i[z],m[z],b[z],T[z],j[z]} (t) }=1,
\tag{1}\]</span></span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(ki_{i[z],m[z],b[z],T[z],j[z]} (t)\)</span> - instantaneous isocratic retention factor corresponding to the mobile phase composition at time t at column inlet for a particular measurement <span class="math inline">\(z\)</span>,</li>
<li><span class="math inline">\(t_0\)</span> - column hold-up (dead) time</li>
<li><span class="math inline">\(t_e\)</span> - extra column-time.</li>
</ul>
<p>On the other hand, the subscripts correspond, respectively:</p>
<ul>
<li>r - dissociation step,</li>
<li>i - analyte,</li>
<li>m - organic modifier (1 for MeOH, 2 for ACN),</li>
<li>j - organic modifier content,</li>
<li>b - pH (b=1,…,9, corresponding to nominal pH of 2.5, 3.3, 4.1, 4.9, 5.8, 6.8, 8.9, 9.7, 10.5, respectively),</li>
<li>T - temperature (1-<span class="math inline">\(25^0C\)</span> and 2-<span class="math inline">\(35^0C\)</span>).</li>
</ul>
<p>The following function described the relationship between the isocratic retention factor and pH for an analyte with R dissociation steps and R+1 forms:</p>
<p><span class="math display">\[\begin{equation}
ki_{i,m,b,T,j}=\frac{k_{1,i,m,b,T,j}+\sum_{r=1}^R k_{r+1,i,m,b,T,j} \cdot 10^{r\cdot pH_{m,b,T,j}-\sum_{r=1}^R pKa_{r,i,m,j} } }{1+\sum_{r=1}^R 10^{r\cdot pH_{m,b,T,j}-\sum_{r=1}^R pKa_{r,i,m,j} } }.
\end{equation}\]</span></p>
<p>Further, it was assumed that <span class="math inline">\(k_{r,i,m,b,T,j}\)</span> depends on the organic modifier content, pH and temperature:</p>
<p><span class="math display">\[\begin{align}
logk_{r,m,i,b,T,j}&amp;=logkw_{r,i}-\frac{S1_{r,i,m}\cdot (1+S2_m )\cdot \varphi_j}{1+S2_m \cdot \varphi_j }+dlogkT_i\cdot (T_t-25)/10+   \\  &amp;+ |chargeA_{r,i} | \cdot apHA \cdot (pH_{m,b,T,j}-7)+ \\  &amp;+ |chargeB_{r,i} | \cdot apHB \cdot (pH_{m,b,T,j}-7),
\end{align}\]</span></p>
<p>where <span class="math inline">\(logkw_{r,i}\)</span> represents logarithm of retention factors extrapolated to <span class="math inline">\(0\%\)</span> of organic modifier content for the neutral and ionized forms of analytes; <span class="math inline">\(S1_{r,i,m}\)</span> and <span class="math inline">\(S2_m\)</span> are the slopes in the Neue equation; <span class="math inline">\(dlogkT_i\)</span> denotes the change in logkw due to the increase in temperature by <span class="math inline">\(10^0C\)</span>.In this parametrization of Neue equation, S1 parameter reflects the difference betweenlogarithm of retention factors corresponding to water (<span class="math inline">\(0\%\)</span> of organic modifier content) and MeOH or ACN (<span class="math inline">\(100\%\)</span> of organic modifier content) as eluents, apH denotes the pH effects (common for all analytes); <span class="math inline">\(chargeA_{r,i}\)</span> and <span class="math inline">\(chargeB_{r,i}\)</span> denote a charge state of an analyte (<span class="math inline">\(chargeA_{r,i}=\{0, -1, -2, \ldots\}\)</span> for acids, and <span class="math inline">\(chargeB_{r,i}=\{0, -1, -2, \ldots\}\)</span> for bases), and <span class="math inline">\(|.|\)</span> denotes absolute value.</p>
<p>The relationship between pH and the content of organic modifier for various combinations of organic modifier and buffer was experimentally determined prior to the chromatographic analysis. In this settings pH and consequently pKa values correspond to <span class="math inline">\({_w^s}pH\)</span> or <span class="math inline">\({_w^s}pKa\)</span> scale. The obtained relationships was then described using quadratic equations for each nominal pH, temperature and organic modifier (36 equations in total):</p>
<p><span class="math display">\[
pH_{m,b,T,j}=pHo_{m,b,T}+\alpha 1_{m,b,T}\cdot \varphi_j+\alpha 2_{m,b,T}\cdot {\varphi_j}^2,
\]</span></p>
<p>where <span class="math inline">\(pHo_{m,b,T}\)</span>,<span class="math inline">\(\alpha 1_{m,b,T}\)</span> and <span class="math inline">\(\alpha 2_{m,b,T}\)</span> are regression coefficient specific for a given condition.</p>
<p>Further a linear relationship between pKa values and the organic modifier content was assumed: <span class="math display">\[
pKa_{r,i,m,j}=pKaw_{r,i}+\alpha_{r,i,m}\cdot\varphi_j       
\]</span></p>
<p>where <span class="math inline">\(pKa_{r,i,m,j}\)</span> denotes dissociationconstant of an analyte in given chromatographic conditions, <span class="math inline">\(pKaw_{r,i}\)</span> denotes aqueous pKa, and <span class="math inline">\(\alpha_{r,i,m}\cdot\varphi_j\)</span> denotes the slope due to changes in organic modifier.The linear relationshipis generally valid for <span class="math inline">\(\varphi_j&lt;0.8\)</span>.</p>
<section id="the-analyte-level-model" class="level3">
<h3 class="anchored" data-anchor-id="the-analyte-level-model">The analyte-level model</h3>
<p>The <span class="math inline">\(logkw_{r,i}\)</span>, <span class="math inline">\(S1_{r,i,m}\)</span> parameters were calculated based on retention parameters of the neutral form of an analyte, and the difference in logkw and S1 values between the neutral and ionized form of an analyte.</p>
<p><span class="math display">\[\begin{align}
&amp;logkw_{r,i}=logkwN_i+|chargeA_{r,i} |\cdot dlogkwA_{r,i}+ |chargeB_{r,i} |\cdot dlogkwB_{r,i}  \\
&amp;S1_{r,i,m=1}=S1mN_i+|chargeA_{r,i} |\cdot dS1mA_{r,i}+ |chargeB_{r,i} |\cdot dS1mB_{r,i}   \\
&amp;S1_{r,i,m=2}=S1aN_i+|chargeA_{r,i} |\cdot dS1aA_{r,i}+ |chargeB_{r,i} |\cdot dS1aB_{r,i}
\end{align}\]</span></p>
<p>Similarly the <span class="math inline">\(\alpha\)</span> parameters were assumed to be different for acids and bases:</p>
<p><span class="math display">\[\begin{align}
&amp;\alpha_{r,i,m=1}=\alpha mA_{r,i}\cdot groupA_{r,i}+\alpha mB_{r,i} \cdot groupB_{r,i}\\
&amp;\alpha_{r,i,m=2}=\alpha aA_{r,i}\cdot groupA_{r,i}+\alpha aB_{r,i} \cdot groupB_{r,i}  
\end{align}\]</span></p>
<p>where <span class="math inline">\(groupA_{r,i}\)</span> and <span class="math inline">\(groupB_{r,i}\)</span> denote the type of dissociating group (<span class="math inline">\(groupA_{r,i}=1\)</span> if acidic and 0 otherwise, <span class="math inline">\(groupB_{r,i}=1\)</span> if basic and 0 otherwise).</p>
<p>The second-level part of the model describes the relationship between analyte-specific parameters and predictors. The pa-rameters for the neutral form of an analyte were assumed to be correlated and related to log P and functional groups:</p>
<p><span class="math display">\[\begin{align}
\begin{bmatrix}
logkwN_i\\
S1mN_i\\
S1aN_i
\end{bmatrix} \sim
MNV \begin{pmatrix}
\theta_{\log kwN}+\beta_{\log kwN}\cdot (\log P_i -2.2)+\pi_{\log kwN}\cdot X &amp; \\
\theta_{S1mN}+\beta_{S1mN}\cdot (\log P_i -2.2)+\pi_{S1mN}\cdot X &amp; \Omega \\
\theta_{S1aN}+\beta_{S1aN}\cdot (\log P_i -2.2)+\pi_{S1aN}\cdot X &amp;
\end{pmatrix}
\end{align}\]</span></p>
<p>where <em>MVN</em> denotes the multivariate normal distribution; <span class="math inline">\(\theta_{\log kwN}\)</span>, <span class="math inline">\(\theta_{S1mN}\)</span> and <span class="math inline">\(\theta_{S1aN}\)</span> are the mean values of individual chromatographic parameters that correspond to a typical analyte with logP=2.2, with no functional groups at <span class="math inline">\(25^0C\)</span>; <span class="math inline">\(\beta_{\log kwN}\)</span>, <span class="math inline">\(\beta_{S1mN}\)</span> and <span class="math inline">\(\beta_{S1aN}\)</span> are regression coefficients between the individual chromatographic parameters and the <span class="math inline">\(\log P_i\)</span> values; <span class="math inline">\(\pi_i\)</span> is an effect of each functional group on chromatographic parameters with separate values for <span class="math inline">\(\log kwN\)</span>, <span class="math inline">\(S1mN\)</span> and <span class="math inline">\(S1aN\)</span>. <span class="math inline">\(\pi\)</span> represents the difference in chromatographic parameters due to the presence of a functional group, assuming all else being equal. <span class="math inline">\(X\)</span> is a matrix of size 187 x 60 that decodes the number of functional groups present on each analyte.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Columns: XBridge Shield and XTerra</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Model_1.html" class="pagination-link">
        <span class="nav-page-text">Model 1</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>